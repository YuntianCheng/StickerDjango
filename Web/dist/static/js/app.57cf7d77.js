(function(t){function e(e){for(var n,o,s=e[0],l=e[1],c=e[2],p=0,d=[];p<s.length;p++)o=s[p],Object.prototype.hasOwnProperty.call(r,o)&&r[o]&&d.push(r[o][0]),r[o]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(t[n]=l[n]);u&&u(e);while(d.length)d.shift()();return i.push.apply(i,c||[]),a()}function a(){for(var t,e=0;e<i.length;e++){for(var a=i[e],n=!0,s=1;s<a.length;s++){var l=a[s];0!==r[l]&&(n=!1)}n&&(i.splice(e--,1),t=o(o.s=a[0]))}return t}var n={},r={app:0},i=[];function o(e){if(n[e])return n[e].exports;var a=n[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=t,o.c=n,o.d=function(t,e,a){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)o.d(a,n,function(e){return t[e]}.bind(null,n));return a},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=e,s=s.slice();for(var c=0;c<s.length;c++)e(s[c]);var u=l;i.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"034f":function(t,e,a){"use strict";a("64a9")},"0d4d":function(t,e,a){},"129c":function(t,e,a){t.exports=a.p+"static/img/6.916e880b.jpg"},2144:function(t,e,a){t.exports=a.p+"static/img/7.e780dc37.jpg"},"344e":function(t,e,a){"use strict";a("0d4d")},"546a":function(t,e,a){t.exports=a.p+"static/img/5.43896059.jpg"},"56d7":function(t,e,a){"use strict";a.r(e);a("cadf"),a("551c"),a("f751"),a("097d");var n=a("2b0e"),r=function(){var t=this,e=this,a=e.$createElement,n=e._self._c||a;return n("div",{ref:"app",attrs:{id:"app"}},[n("el-card",{staticClass:"card",attrs:{shadow:"always"}},[n("el-row",{attrs:{type:"flex",justify:"center"}},[n("el-col",[n("el-steps",{attrs:{active:e.active,"finish-status":"success","align-center":""}},[n("el-step",{attrs:{title:"上传图片"}}),n("el-step",{attrs:{title:"选择模版"}}),n("el-step",{attrs:{title:"生成表情包"}})],1)],1)],1),n("el-row",{attrs:{type:"flex",justify:"center"}},[n("el-col",[n("div",{ref:"main",staticStyle:{"margin-top":"20px"}},[1==e.active?n("photograph",{on:{upload:e.upload},model:{value:e.headImage,callback:function(t){e.headImage=t},expression:"headImage"}}):e._e(),2==e.active?n("el-row",{attrs:{gutter:20,type:"flex",justify:"center"}},[n("el-col",{attrs:{span:9}},[n("el-card",[n("div",{attrs:{slot:"header"},slot:"header"},[n("span",[e._v("选择模版")])]),n("div",[n("el-table",{ref:"faceTable",staticStyle:{width:"260px"},attrs:{"show-header":!1,"highlight-current-row":"",data:e.tableData,height:250,"max-height":250},on:{"row-click":e.handleSelect}},[n("el-table-column",{attrs:{width:"2px"}}),n("el-table-column",{scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-card",[n("el-image",{staticStyle:{width:"200px",height:"200px"},attrs:{src:t.row.img}})],1)]}}],null,!1,2901843003)})],1)],1)])],1),n("el-col",{attrs:{span:9}},[n("el-card",[n("div",{attrs:{slot:"header"},slot:"header"},[n("span",[e._v("模版描述")])]),n("div",{staticStyle:{height:"250px"}},[n("span",{staticStyle:{"margin-top":"20%"}},[e._v(e._s(e.description))])])])],1)],1):e._e(),3==e.active?n("el-row",{attrs:{type:"flex",justify:"center"}},[n("el-col",{attrs:{span:12}},[n("el-image",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"400px",height:"400px"},attrs:{"element-loading-text":"表情包生成中","element-loading-spinner":"el-icon-loading",src:e.face,fit:e.fit}})],1)],1):e._e()],1)])],1),n("el-row",{staticStyle:{"margin-top":"10px"},attrs:{type:"flex",justify:"center"}},[3!=e.active?n("el-col",{attrs:{span:3}},[n("el-button",{attrs:{disabled:e.next,type:"primary"},on:{click:e.nextStep}},[e._v("下一步")])],1):e._e(),2==e.active?n("el-col",{attrs:{span:3}},[n("el-button",{on:{click:e.preStep}},[e._v("上一步")])],1):e._e(),3==e.active?n("el-col",{attrs:{span:6}},[n("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("保存")]),n("el-button",{attrs:{type:"danger"},on:{click:function(){t.active=1}}},[e._v("重新开始")])],1):e._e()],1)],1)],1)},i=[],o=(a("6b54"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"avatar",staticClass:"avatar",class:{complete:t.headerImage}},[a("input",{staticClass:"avatar-file",attrs:{type:"file",name:"",id:"avatar",accept:"image/*"},on:{change:t.uploadFile}}),a("label",{staticClass:"avatar-label",attrs:{for:"avatar"}})])}),s=[],l=a("6f45"),c=a.n(l),u={name:"photograph",data:function(){return{headerImage:"",avatarFile:""}},methods:{uploadFile:function(t){var e=t.target.files||t.dataTransfer.files;e.length&&(this.avatarFile=e[0],this.imgPreview(this.avatarFile),console.log("image",this.avatarFile))},imgPreview:function(t){var e,a=this;if(c.a.getData(t,(function(){e=c.a.getTag(this,"Orientation")})),t&&window.FileReader&&/^image/.test(t.type)){var n=new FileReader;n.readAsDataURL(t),n.onloadend=function(){var t=this.result,n=new Image;n.src=t,this.result.length<=102400?(a.headerImage=this.result,a.postImg()):n.onload=function(){var t=a.compress(n,e);a.headerImage=t,a.postImg()}}}},postImg:function(){this.$emit("upload",this.avatarFile),this.$emit("input",this.avatarFile),this.$refs.avatar.style.background="url(".concat(this.headerImage,")no-repeat center/contain")},rotateImg:function(t,e,a){var n=0,r=3;if(null!=t){var i=t.height,o=t.width,s=2;null==s&&(s=n),"right"===e?(s++,s>r&&(s=n)):(s--,s<n&&(s=r));var l=90*s*Math.PI/180,c=a.getContext("2d");switch(s){case 0:a.width=o,a.height=i,c.drawImage(t,0,0);break;case 1:a.width=i,a.height=o,c.rotate(l),c.drawImage(t,0,-i);break;case 2:a.width=o,a.height=i,c.rotate(l),c.drawImage(t,-o,-i);break;case 3:a.width=i,a.height=o,c.rotate(l),c.drawImage(t,-o,0);break}}},compress:function(t,e){var a,n,r=document.createElement("canvas"),i=r.getContext("2d"),o=document.createElement("canvas"),s=o.getContext("2d"),l=t.src.length,c=t.width,u=t.height;if((a=c*u/4e6)>1?(console.log("大于400万像素"),a=Math.sqrt(a),c/=a,u/=a):a=1,r.width=c,r.height=u,i.fillStyle="#fff",i.fillRect(0,0,r.width,r.height),(n=c*u/1e6)>1){console.log("超过100W像素"),n=~~(Math.sqrt(n)+1);var p=~~(c/n),d=~~(u/n);o.width=p,o.height=d;for(var h=0;h<n;h++)for(var f=0;f<n;f++)s.drawImage(t,h*p*a,f*d*a,p*a,d*a,0,0,p,d),i.drawImage(o,h*p,f*d,p,d)}else i.drawImage(t,0,0,c,u);if(""!==e&&1!==e)switch(e){case 6:this.rotateImg(t,"left",r);break;case 8:this.rotateImg(t,"right",r);break;case 3:this.rotateImg(t,"right",r),this.rotateImg(t,"right",r);break}var g=r.toDataURL("image/jpeg",.1);return console.log("压缩前："+l),console.log("压缩后："+g.length),console.log("压缩率："+~~(100*(l-g.length)/l)+"%"),o.width=o.height=r.width=r.height=0,g}}},p=u,d=(a("344e"),a("2877")),h=Object(d["a"])(p,o,s,!1,null,"67f5ca3b",null),f=h.exports,g=a("a2ba"),v=a.n(g),m=7,b=["化身马老师痛斥现在的年轻人不讲武德，建议搭配气急败坏照片","武林风气不佳，规劝大家不要搞内斗，建议搭配痛心疾首照片","粗心大意之下被偷袭成功，以自身经历告诉大家随时保持警惕，建议搭配挨打后的照片","69岁的老人被偷袭，是道德的沦丧，还是人性的泯灭，化身69岁老同志对年轻人发出抗议，建议搭配急了的照片","奉劝年轻人好自为之，展现自己大度的一面，建议搭配一脸深沉照片","看见大佬的激动之情溢于言表，展现自己迷弟迷妹的一面，建议搭配花痴照片","阴险狡诈之辈专用，偷袭前发送可干扰对方判断，建议搭配贼眉鼠眼照片"],w=a("d225"),y=a("b0b4"),x=a("bc3a"),j=a.n(x),I=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:baseURL;Object(w["a"])(this,t),this.baseUrl=e,this.queue={}}return Object(y["a"])(t,[{key:"getInsideConfig",value:function(){var t={baseURL:this.baseUrl,headers:{}};return t}},{key:"destroy",value:function(t){delete this.queue[t]}},{key:"interceptors",value:function(t,e){var a=this;t.interceptors.request.use((function(t){return a.queue[e]=!0,t}),(function(t){return Promise.reject(t)})),t.interceptors.response.use((function(t){a.destroy(e);var n=t.data,r=t.status,i=t.headers;return{data:n,status:r,headers:i}}),(function(t){a.destroy(e);t.response;return 401===status&&window.location.reload(),Promise.reject(t)}))}},{key:"request",value:function(t){var e=j.a.create({}),a=this.getInsideConfig();return t=Object.assign(a,t),this.interceptors(e,t.url),e(t)}}]),t}(),_=I,k={dev:"",pro:"http://127.0.0.1:8000"},O=!1,S=O?k.dev:k.pro,F={projectName:"表情包生成器",isDev:O,url:S,cookieExpires:1,useI18n:!0,baseUrl:k},P=F.baseUrl.pro,C=new _(P),U=C;function D(t){return U.request({url:"/api/get_sticks/",headers:{"Content-Type":"multipart/form-data"},method:"post",data:t,responseType:"blob"})}var R=a("9afa"),T=a.n(R),q={name:"app",components:{Photograph:f},data:function(){return{headImage:"",disabled:!0,next:!0,tableData:[],select:null,face:null,noView:v.a,active:1,loading:!0,description:""}},methods:{upload:function(){this.next=!1},handleSelect:function(t){this.$refs.faceTable.setCurrentRow(t),this.disabled=!1,this.next=!1,this.select=t.imgIndex,this.description=b[t.imgIndex],console.log(t.imgIndex)},Init:function(){for(var t={color:"0,0,255",count:200},e=(new T.a(this.$refs["app"],t),1);e<=m;e++){var n="@/assets/images/"+e.toString()+".jpg";console.log(n),this.tableData.push({imgIndex:e,img:a("b5a1")("./"+e.toString()+".jpg")})}},handleFace:function(){var t=this;this.loading=!0;var e=new FormData;e.append("name",this.select),e.append("image",this.headImage),D(e).then((function(e){t.loading=!1,t.face=window.URL.createObjectURL(e.data)}))},nextStep:function(){this.active++,this.next=!0,3==this.active&&this.handleFace()},preStep:function(){this.active--}},mounted:function(){this.Init()}},M=q,$=(a("034f"),Object(d["a"])(M,r,i,!1,null,null,null)),E=$.exports,L=a("5c96"),N=a.n(L);a("0fae");n["default"].use(N.a),n["default"].config.productionTip=!1,new n["default"]({render:function(t){return t(E)}}).$mount("#app")},"593c":function(t,e,a){t.exports=a.p+"static/img/2.c5fe1dd1.jpg"},"64a9":function(t,e,a){},6800:function(t,e,a){t.exports=a.p+"static/img/3.e7dc703f.jpg"},"98a8":function(t,e,a){t.exports=a.p+"static/img/1.3f66f7ce.jpg"},a2ba:function(t,e,a){t.exports=a.p+"static/img/noView.2f191c96.jpg"},b5a1:function(t,e,a){var n={"./1.jpg":"98a8","./2.jpg":"593c","./3.jpg":"6800","./4.jpg":"ffd7","./5.jpg":"546a","./6.jpg":"129c","./7.jpg":"2144","./noView.jpg":"a2ba"};function r(t){var e=i(t);return a(e)}function i(t){if(!a.o(n,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return n[t]}r.keys=function(){return Object.keys(n)},r.resolve=i,t.exports=r,r.id="b5a1"},ffd7:function(t,e,a){t.exports=a.p+"static/img/4.a0e81b62.jpg"}});
//# sourceMappingURL=app.57cf7d77.js.map